<?xml version="1.0" encoding="UTF-8"?>
<mah:MetroWindow x:Name="MainView"
                 x:Class="NTC.FamilyManager.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 mc:Ignorable="d"
                 xmlns:local="clr-namespace:NTC.FamilyManager"
                 xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                 xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                 xmlns:views="clr-namespace:NTC.FamilyManager.Views"
                 d:DataContext="{d:DesignInstance local:MainViewModel}"
                 KeyDown="MainWindow_KeyDown"
                 Title="Newtecons - SharePoint Family Management"
                 ResizeMode="CanResize"
                 ShowInTaskbar="True"
                 WindowStartupLocation="CenterScreen"
                 Height="600"
                 Width="800"
                 MinHeight="400"
                 MinWidth="500"
                 Topmost="True">
    <mah:MetroWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/MahApps.Metro.ALB;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="/MahApps.Metro.ALB;component/styles/light.blue.xaml" />
                <ResourceDictionary Source="/MaterialDesignThemes.Wpf.ALB;component/Themes/materialdesigntheme.light.xaml" />
                <ResourceDictionary Source="/MaterialDesignThemes.Wpf.ALB;component/Themes/materialdesigntheme.defaults.xaml" />
                <ResourceDictionary Source="/AlphaBIMWPF;component/Resource/Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <local:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" />
            <Style TargetType="{x:Type Button}"
                   BasedOn="{StaticResource ButtonStyle}" />
        </ResourceDictionary>
    </mah:MetroWindow.Resources>
    <DockPanel x:Name="MainPanel"
               LastChildFill="True">
        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom"
                   Background="#F3F3F3">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}"
                           FontSize="11"
                           Foreground="#555" />
            </StatusBarItem>
        </StatusBar>
        <!-- Main Content Area -->
        <Grid x:Name="MainGrid">
            <!-- NOT LOGGED IN STATE -->
            <Grid Visibility="{Binding IsLoggedIn, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                <Grid.Background>
                    <LinearGradientBrush StartPoint="0.5,0"
                                         EndPoint="0.5,1">
                        <GradientStop Color="#FFFFFF"
                                      Offset="0" />
                        <GradientStop Color="#F3F4F6"
                                      Offset="1" />
                    </LinearGradientBrush>
                </Grid.Background>
                <StackPanel VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Width="480">
                    <!-- Branded Logo Section -->
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                Margin="0,0,0,40">
                        <Border Background="#E32526"
                                Width="60"
                                Height="60"
                                CornerRadius="4">
                            <TextBlock Text="N"
                                       Foreground="White"
                                       FontSize="45"
                                       FontWeight="ExtraBold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Margin="0,-5,0,0" />
                        </Border>
                        <StackPanel Margin="15,5,0,0">
                            <TextBlock Text="NEWTECONS"
                                       FontSize="34"
                                       FontWeight="Bold"
                                       Foreground="#00548B" />
                            <Border Background="#00548B"
                                    Height="1"
                                    Margin="0,2,0,2" />
                            <TextBlock Text="B U I L D  O N  T R U S T"
                                       FontSize="10"
                                       Foreground="#666"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Right" />
                        </StackPanel>
                    </StackPanel>
                    <!-- Login Card -->
                    <materialDesign:Card Padding="40"
                                         materialDesign:ShadowAssist.ShadowDepth="Depth2"
                                         UniformCornerRadius="8"
                                         Background="White">
                        <StackPanel>
                            <TextBlock Text="Đăng nhập"
                                       FontSize="28"
                                       FontWeight="Bold"
                                       Foreground="#1F2937"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,10" />
                            <TextBlock Text="Sử dụng tài khoản Microsoft của bạn để tiếp tục"
                                       FontSize="14"
                                       Foreground="#6B7280"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,35" />
                            <Button Command="{Binding LoginCommand}"
                                    Height="50"
                                    Style="{DynamicResource MaterialDesignRaisedButton}"
                                    Background="#2563EB"
                                    BorderBrush="{x:Null}"
                                    materialDesign:ButtonAssist.CornerRadius="6">
                                <Grid Width="280">
                                    <Viewbox Width="20"
                                             Height="20"
                                             HorizontalAlignment="Left">
                                        <Grid Width="20"
                                              Height="20">
                                            <Rectangle Fill="#F25022"
                                                       HorizontalAlignment="Left"
                                                       VerticalAlignment="Top"
                                                       Width="9"
                                                       Height="9" />
                                            <Rectangle Fill="#7FBA00"
                                                       HorizontalAlignment="Right"
                                                       VerticalAlignment="Top"
                                                       Width="9"
                                                       Height="9" />
                                            <Rectangle Fill="#00A4EF"
                                                       HorizontalAlignment="Left"
                                                       VerticalAlignment="Bottom"
                                                       Width="9"
                                                       Height="9" />
                                            <Rectangle Fill="#FFB900"
                                                       HorizontalAlignment="Right"
                                                       VerticalAlignment="Bottom"
                                                       Width="9"
                                                       Height="9" />
                                        </Grid>
                                    </Viewbox>
                                    <TextBlock Text="Đăng nhập với Microsoft"
                                               FontSize="15"
                                               FontWeight="SemiBold"
                                               Foreground="White"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center" />
                                </Grid>
                            </Button>
                            <TextBlock Text="Cửa sổ đăng nhập Microsoft sẽ mở ra để bạn đăng nhập bằng tài khoản Microsoft của công ty."
                                       FontSize="12"
                                       Foreground="#9CA3AF"
                                       HorizontalAlignment="Center"
                                       Margin="0,30,0,0"
                                       TextWrapping="Wrap"
                                       TextAlignment="Center"
                                       LineHeight="18" />
                        </StackPanel>
                    </materialDesign:Card>
                    <TextBlock Text="© 2025 CÔNG TY CỔ PHẦN ĐẦU TƯ XÂY DỰNG NEWTECONS"
                               FontSize="11"
                               Foreground="#9CA3AF"
                               HorizontalAlignment="Center"
                               Margin="0,50,0,0"
                               FontWeight="Medium" />
                </StackPanel>
            </Grid>
            <!-- LOGGED IN STATE -->
            <Grid Visibility="{Binding IsLoggedIn, Converter={StaticResource BooleanToVisibilityConverter}}">
                <views:FamilyExplorerView DataContext="{Binding ExplorerVM}" />
            </Grid>
        </Grid>
    </DockPanel>
</mah:MetroWindow>